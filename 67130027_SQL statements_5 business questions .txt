#‡πÇ‡∏à‡∏ó‡∏¢‡πå  SQL statements you use to answer 5 business questions
#‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ ‡πÉ‡∏ä‡πâ data base pgAdmin 4 ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 17

#‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á SQL ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à 5 ‡∏Ç‡πâ‡∏≠

#üîπ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà 1: ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (AVG) ‡∏Ç‡∏≠‡∏á aqius ‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á air_quality (shema ‡∏ä‡∏∑‡πà‡∏≠ air_api ) ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå city ‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£  
‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå timestamp ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 29/03/2568 ‡∏ñ‡∏∂‡∏á 02/03/2568 ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á


SELECT 
    AVG(aqius) AS avg_aqius
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02';


#üîπ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà 2: ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (max) ‡∏Ç‡∏≠‡∏á aqius ‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á air_quality (shema ‡∏ä‡∏∑‡πà‡∏≠ air_api ) ‡πÉ‡∏ô ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå city ‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£  
‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå timestamp ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 29/03/2568 ‡∏ñ‡∏∂‡∏á 02/03/2568 ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á


SELECT 
    MAX(aqius) AS max_aqius
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02';


#üîπ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà 3: ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (min) ‡∏Ç‡∏≠‡∏á aqius ‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á air_quality (shema ‡∏ä‡∏∑‡πà‡∏≠ air_api )‡πÉ‡∏ô ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå city ‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£ 
‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå timestamp ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 29/03/2568 ‡∏ñ‡∏∂‡∏á 02/03/2568 

SELECT 
    MIN(aqius) AS max_aqius
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02';

#üîπ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà 4: ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Average) ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏ô, ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏°‡πÅ‡∏•‡∏∞‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏•‡∏° 
‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á air_quality (shema ‡∏ä‡∏∑‡πà‡∏≠ air_api ) ‡πÉ‡∏ô ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå city ‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£  
‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå timestamp ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 29/03/2568 ‡∏ñ‡∏∂‡∏á 02/03/2568 ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á

#‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
SELECT 
    AVG(temp) AS avg_temp
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02';

#‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô
SELECT 
    AVG(pressure) AS avg_pressure
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02';

#‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏ô
SELECT 
    AVG(humidity) AS avg_humidity
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02';

#‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏°
SELECT 
    AVG(wind_speed) AS avg_winspeed
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02'

#‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏•‡∏°	
SELECT 
    AVG(wind_direction) AS avg_direction
FROM 
    air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02'


#üîπ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà 5: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå temp ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á air_quality (shema ‡∏ä‡∏∑‡πà‡∏≠ air_api ) ‡πÉ‡∏ô ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå city ‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£  
‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏°‡πå timestamp ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 29/03/2568 ‡∏ñ‡∏∂‡∏á 02/03/2568 ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á

SELECT temp
FROM air_api.air_quality
WHERE 
    city = 'Chatuchak'
    AND timestamp BETWEEN '2025-03-29' AND '2025-04-02'
ORDER BY id ASC
LIMIT 100;
